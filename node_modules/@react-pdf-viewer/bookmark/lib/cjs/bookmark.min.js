"use strict";var e=require("@react-pdf-viewer/core");function t(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(o){if("default"!==o){var r=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,r.get?r:{enumerable:!0,get:function(){return e[o]}})}})),t.default=e,Object.freeze(t)}var o,r=t(require("react")),n=function(){return r.createElement(e.Icon,{size:16},r.createElement("path",{d:"M6.427,8.245A.5.5,0,0,1,6.862,7.5H17.138a.5.5,0,0,1,.435.749l-5.139,9a.5.5,0,0,1-.868,0Z"}))},a=function(){return r.createElement(e.Icon,{size:16},r.createElement("path",{d:"M9.248,17.572a.5.5,0,0,1-.748-.434V6.862a.5.5,0,0,1,.748-.434l8.992,5.138a.5.5,0,0,1,0,.868Z"}))},i=function(e){var t=e.bookmark,o=e.depth,i=e.doc,m=e.index,s=e.isBookmarkExpanded,l=e.numberOfSiblings,u=e.pathFromRoot,k=e.renderBookmarkItem,d=e.store,p=e.onJumpToDest,f=u?"".concat(u,".").concat(m):"".concat(m),b=r.useMemo((function(){return function(e){var t=e.count,o=e.items;if(t>=0)return!1;var r=o.length;if(0===r)return!1;for(var n=o.concat([]);n.length>0;){var a=n.shift(),i=a.items;a.count&&i&&a.count>0&&i.length>0&&(r+=i.length,n=n.concat(i))}return Math.abs(t)===r}(t)}),[t]),v=d.get("bookmarkExpandedMap"),E=s?s({bookmark:t,doc:i,depth:o,index:m}):v.has(f)?v.get(f):!b,g=r.useState(E),_=g[0],h=g[1],x=t.items&&t.items.length>0,B=function(){var e=!_;d.updateCurrentValue("bookmarkExpandedMap",(function(t){return t.set(f,e)})),h(e)},D=function(){x&&t.dest&&p(t.dest)},I=function(){!x&&t.dest&&p(t.dest)},T=function(e,t){return r.createElement("div",{className:"rpv-bookmark__item",style:{paddingLeft:"".concat(1.25*o,"rem")},onClick:e},t)},w=function(e,t){return x?r.createElement("span",{className:"rpv-bookmark__toggle","data-testid":"bookmark__toggle-".concat(o,"-").concat(m),onClick:B},_?e:t):r.createElement("span",{className:"rpv-bookmark__toggle"})},C=function(e){return t.url?r.createElement("a",{className:"rpv-bookmark__title",href:t.url,rel:"noopener noreferrer nofollow",target:t.newWindow?"_blank":""},t.title):r.createElement("div",{className:"rpv-bookmark__title","aria-label":t.title,onClick:e},t.title)};return r.createElement("li",{"aria-expanded":_?"true":"false","aria-label":t.title,"aria-level":o+1,"aria-posinset":m+1,"aria-setsize":l,role:"treeitem",tabIndex:-1},k?k({bookmark:t,depth:o,hasSubItems:x,index:m,isExpanded:_,path:f,defaultRenderItem:T,defaultRenderTitle:C,defaultRenderToggle:w,onClickItem:I,onClickTitle:D,onToggleSubItems:B}):T(I,r.createElement(r.Fragment,null,w(r.createElement(n,null),r.createElement(a,null)),C(D))),x&&_&&r.createElement(c,{bookmarks:t.items,depth:o+1,doc:i,isBookmarkExpanded:s,isRoot:!1,pathFromRoot:f,renderBookmarkItem:k,store:d,onJumpToDest:p}))},c=function(e){var t=e.bookmarks,o=e.depth,n=void 0===o?0:o,a=e.doc,c=e.isBookmarkExpanded,m=e.isRoot,s=e.pathFromRoot,l=e.renderBookmarkItem,u=e.store,k=e.onJumpToDest;return r.createElement("ul",{className:"rpv-bookmark__list",role:m?"tree":"group",tabIndex:-1},t.map((function(e,o){return r.createElement(i,{bookmark:e,depth:n,doc:a,index:o,isBookmarkExpanded:c,key:o,numberOfSiblings:t.length,pathFromRoot:s,renderBookmarkItem:l,store:u,onJumpToDest:k})})))};!function(e){e[e.Collapse=0]="Collapse",e[e.Expand=1]="Expand"}(o||(o={}));var m=function(t){var n=t.bookmarks,a=t.doc,i=t.isBookmarkExpanded,m=t.renderBookmarkItem,s=t.store,l=t.onJumpToDest,u=r.useRef(),k=function(e){var t=u.current;if(t&&e.target instanceof HTMLElement&&t.contains(e.target))switch(e.key){case"ArrowDown":e.preventDefault(),p((function(e,t){return e.indexOf(t)+1}));break;case"ArrowLeft":e.preventDefault(),f(o.Collapse);break;case"ArrowRight":e.preventDefault(),f(o.Expand);break;case"ArrowUp":e.preventDefault,p((function(e,t){return e.indexOf(t)-1}));break;case"End":e.preventDefault(),p((function(e,t){return e.length-1}));break;case" ":case"Enter":case"Space":e.preventDefault(),d();break;case"Home":e.preventDefault(),p((function(e,t){return 0}))}},d=function(){var e=document.activeElement.closest(".rpv-bookmark__item").querySelector(".rpv-bookmark__title");e&&e.click()},p=function(e){var t=u.current,o=[].slice.call(t.getElementsByClassName("rpv-bookmark__item"));if(0!==o.length){var r=document.activeElement,n=o[Math.min(o.length-1,Math.max(0,e(o,r)))];r.setAttribute("tabindex","-1"),n.setAttribute("tabindex","0"),n.focus()}},f=function(e){var t=u.current;if(0!==[].slice.call(t.getElementsByClassName("rpv-bookmark__item")).length){var r=document.activeElement.closest(".rpv-bookmark__item"),n=e===o.Collapse?"true":"false";if(r&&r.parentElement.getAttribute("aria-expanded")===n){var a=r.querySelector(".rpv-bookmark__toggle");a&&a.click()}}};return r.useEffect((function(){return document.addEventListener("keydown",k),function(){document.removeEventListener("keydown",k)}}),[]),r.useEffect((function(){var e=u.current;if(e){var t=[].slice.call(e.getElementsByClassName("rpv-bookmark__item"));t.length>0&&(t[0].focus(),t[0].setAttribute("tabindex","0"))}}),[]),r.createElement("div",{ref:u},r.createElement(c,{bookmarks:n,depth:0,doc:a,isBookmarkExpanded:i,isRoot:!0,pathFromRoot:"",renderBookmarkItem:m,store:s,onJumpToDest:function(t){e.getDestination(a,t).then((function(e){var t=e.pageIndex,o=e.bottomOffset,r=e.leftOffset,n=e.scaleTo;l(t,o,r,n)}))}}))},s=function(t){var o=t.doc,n=t.isBookmarkExpanded,a=t.renderBookmarkItem,i=t.store,c=t.onJumpToDest,s=r.useContext(e.LocalizationContext).l10n,l=r.useContext(e.ThemeContext).direction===e.TextDirection.RightToLeft,u=r.useState({isLoaded:!1,items:[]}),k=u[0],d=u[1];return r.useEffect((function(){d({isLoaded:!1,items:[]}),o.getOutline().then((function(e){d({isLoaded:!0,items:e||[]})}))}),[o]),k.isLoaded?0===k.items.length?r.createElement("div",{"data-testid":"bookmark__empty",className:e.classNames({"rpv-bookmark__empty":!0,"rpv-bookmark__empty--rtl":l})},s&&s.bookmark?s.bookmark.noBookmark:"There is no bookmark"):r.createElement("div",{"data-testid":"bookmark__container",className:e.classNames({"rpv-bookmark__container":!0,"rpv-bookmark__container--rtl":l})},r.createElement(m,{bookmarks:k.items,doc:o,isBookmarkExpanded:n,renderBookmarkItem:a,store:i,onJumpToDest:c})):r.createElement("div",{className:"rpv-bookmark__loader"},r.createElement(e.Spinner,null))},l=function(t){var o=t.isBookmarkExpanded,n=t.renderBookmarkItem,a=t.store,i=r.useState(a.get("doc")),c=i[0],m=i[1],l=function(e){m(e)};return r.useEffect((function(){return a.subscribe("doc",l),function(){a.unsubscribe("doc",l)}}),[]),c?r.createElement(s,{doc:c,isBookmarkExpanded:o,renderBookmarkItem:n,store:a,onJumpToDest:function(e,t,o,r){var n=a.get("jumpToDestination");n&&n(e,t,o,r)}}):r.createElement("div",{className:"rpv-bookmark__loader"},r.createElement(e.Spinner,null))};exports.DownArrowIcon=n,exports.RightArrowIcon=a,exports.bookmarkPlugin=function(){var t=r.useMemo((function(){return e.createStore({bookmarkExpandedMap:new Map})}),[]);return{install:function(e){t.update("jumpToDestination",e.jumpToDestination)},onDocumentLoad:function(e){t.update("doc",e.doc)},Bookmarks:function(e){return r.createElement(l,{isBookmarkExpanded:null==e?void 0:e.isBookmarkExpanded,renderBookmarkItem:null==e?void 0:e.renderBookmarkItem,store:t})}}};
